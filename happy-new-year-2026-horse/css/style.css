:root{
  --bg1:#b40d2b;
  --bg2:#ff214a;
  --gold:#ffd27a;
  --gold2:#ffb84d;
  --ink:#fff;
  /* brighter glass for the card */
  --glass:rgba(255,255,255,.24);
  --glass2:rgba(0,0,0,.12);
  --shadow:0 20px 55px rgba(0,0,0,.28);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  color:var(--ink);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  overflow-x:hidden;
  position:relative;
}

/* Ensure the current view can inherit 100% height from body/html.
   Without this, percentage heights on children can collapse and scrolling breaks. */
.view{position:relative; z-index:2; height:100%;}
.view[hidden]{display:none !important;}

/* background */
.bg{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0;
  background:
    radial-gradient(900px 600px at 15% 10%, rgba(255,210,122,.34), transparent 60%),
    radial-gradient(800px 700px at 90% 20%, rgba(255,184,77,.30), transparent 55%),
    radial-gradient(800px 700px at 70% 95%, rgba(255,255,255,.16), transparent 55%),
    linear-gradient(160deg, var(--bg1), var(--bg2));
}

.bg-canvas{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  pointer-events:none;
  z-index:1;
}
.bg::after{
  content:"";
  position:absolute;
  inset:-40px;
  background:
    radial-gradient(circle at 12px 12px, rgba(255,255,255,.06) 2px, transparent 2.5px);
  background-size:26px 26px;
  opacity:.6;
  transform:rotate(8deg);
}

.glass{
  background:linear-gradient(180deg, rgba(255,255,255,.30), rgba(255,255,255,.16));
  border:1px solid rgba(255,255,255,.22);
  border-radius:22px;
  box-shadow:0 18px 50px rgba(0,0,0,.22), 0 0 0 1px rgba(255,255,255,.10) inset;
  backdrop-filter: blur(12px) saturate(1.15);
}

/* Brighter main card */
.stage.glass{
  background:linear-gradient(180deg, rgba(255,255,255,.42), rgba(255,255,255,.26));
}

.page-countdown{
  height:100vh;
  height:100svh;
  overflow:hidden;
}

.page-countdown .shell{
  position:relative;
  z-index:2;
  height:100%;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  padding:clamp(16px, 3.2vh, 36px) 18px;
  overflow-y:auto;
  overflow-x:hidden;
  -webkit-overflow-scrolling:touch;
}

.top{max-width:880px; text-align:center; margin-bottom:16px}
.badge{
  display:inline-block;
  padding:8px 14px;
  border-radius:999px;
  background:rgba(0,0,0,.18);
  border:1px solid rgba(255,255,255,.16);
  letter-spacing:.08em;
  font-weight:700;
  font-size:12px;
}
.title{
  margin:14px 0 6px;
  font-family:"Lobster", system-ui;
  font-size:44px;
  line-height:1.05;
  text-shadow:0 10px 24px rgba(0,0,0,.25);
}
.sub{margin:0; opacity:.9}

.card{width:min(920px, 100%); padding:22px 18px}

.count-grid{
  display:grid;
  grid-template-columns:repeat(4, minmax(0,1fr));
  gap:12px;
}
.count-item{
  background:rgba(0,0,0,.16);
  border:1px solid rgba(255,255,255,.14);
  border-radius:18px;
  padding:14px 10px;
  text-align:center;
}
.num{
  font-family:"Fredoka One", system-ui;
  font-size:34px;
  line-height:1;
  color:var(--gold);
  text-shadow:0 10px 18px rgba(0,0,0,.28);
}
.lab{margin-top:8px; opacity:.95}

.hero-row{
  position:relative;
  margin:18px 0 6px;
  height:230px;
  display:flex;
  align-items:flex-end;
  justify-content:center;
  gap:18px;
}

.year-stamp{
  position:absolute;
  right:18px;
  bottom:10px;
  font-family:"Caramel", system-ui;
  font-size:86px;
  color:rgba(255,210,122,.85);
  text-shadow:0 16px 30px rgba(0,0,0,.32);
  transform:rotate(-6deg);
}

.horse-img{
  width:min(260px, 65vw);
  height:auto;
  filter: drop-shadow(0 18px 28px rgba(0,0,0,.35));
  transform-origin:50% 90%;
}
.float{animation:float 3.2s ease-in-out infinite}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}

/* Lantern */
.lantern{
  width:64px;
  height:150px;
  position:relative;
  filter: drop-shadow(0 16px 22px rgba(0,0,0,.35));
}
.lantern-core{
  position:absolute;
  inset:18px 10px 38px 10px;
  border-radius:28px;
  background:radial-gradient(circle at 35% 30%, rgba(255,255,255,.22), transparent 40%),
             linear-gradient(180deg, #ff2d41, #b4001f);
  border:2px solid rgba(255,210,122,.55);
}
.lantern::before,
.lantern::after{
  content:"";
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  width:52px;
  height:14px;
  border-radius:10px;
  background:linear-gradient(180deg, rgba(255,210,122,.9), rgba(255,184,77,.75));
}
.lantern::before{top:8px}
.lantern::after{bottom:30px}
.lantern-tail{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  bottom:4px;
  width:8px;
  height:30px;
  background:linear-gradient(180deg, rgba(255,210,122,.85), rgba(255,184,77,.65));
  border-radius:10px;
  box-shadow:0 0 0 2px rgba(0,0,0,.05);
}

.cta{margin-top:12px; display:flex; flex-direction:column; gap:10px; align-items:center}
.btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:12px 18px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.18);
  background:linear-gradient(180deg, rgba(255,210,122,.95), rgba(255,184,77,.88));
  color:#4b0b12;
  text-decoration:none;
  font-weight:900;
  letter-spacing:.02em;
  box-shadow:0 16px 26px rgba(0,0,0,.25);
  cursor:pointer;
  user-select:none;
}
.btn:active{transform:translateY(1px)}
.note{opacity:.9; font-size:14px; text-align:center}
.footer{margin-top:16px; opacity:.8; font-size:13px}

@media (max-width:640px){
  .title{font-size:36px}
  .count-grid{grid-template-columns:repeat(2, minmax(0,1fr))}
  .hero-row{height:210px}
  .year-stamp{font-size:72px}
}

/* INTRO PAGE */
/* Make intro fill viewport but allow scrolling when content overflows */
.page-intro{
  /* Allow scrolling if content is taller than the viewport */
  min-height:100vh;
  min-height:100svh;
  overflow-x:hidden;
  overflow-y:auto;
}

/* The unlocked view must also be 100% height, otherwise .scene{height:100%}
   won't resolve and the page becomes non-scrollable. */
.page-intro .view-card{height:100%;}
.scene{
  z-index:2;
  min-height:100vh;
  min-height:100svh;
  height:auto;
  display:flex;
  justify-content:center; /* center horizontally */
  align-items:stretch;
  padding:clamp(14px, 2.8vh, 28px) 16px;
  position:relative;
  overflow:visible;
}
.stage{
  width:min(960px, 100%);
  padding:22px 18px;
  margin:auto;              /* center vertically when there is room */
  position:relative;
  overflow:hidden;          /* keep decorative overflow clipped */
}
.stage::before{
  content:"";
  position:absolute;
  inset:-2px;
  border-radius:22px;
  border:1px solid rgba(255,255,255,.18);
  pointer-events:none;
}

.ring{
  position:absolute;
  width:min(620px, 92vw);
  aspect-ratio:1;
  border-radius:50%;
  border:2px solid rgba(255,210,122,.22);
  box-shadow:0 0 0 18px rgba(255,210,122,.04);
  filter: drop-shadow(0 24px 60px rgba(0,0,0,.20));
  animation:ringPulse 5s ease-in-out infinite;
}
@keyframes ringPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.02)}}

.sparkles{position:absolute; inset:0; pointer-events:none}
.sparkles span{
  position:absolute;
  width:6px; height:6px;
  border-radius:50%;
  background:rgba(255,255,255,.65);
  box-shadow:0 0 18px rgba(255,255,255,.35);
  opacity:.55;
  animation:twinkle 2.6s ease-in-out infinite;
}
@keyframes twinkle{0%,100%{transform:scale(.8); opacity:.25}50%{transform:scale(1.2); opacity:.75}}
/* place sparkles */
.sparkles span:nth-child(1){left:10%; top:18%}
.sparkles span:nth-child(2){left:24%; top:10%}
.sparkles span:nth-child(3){left:40%; top:20%}
.sparkles span:nth-child(4){left:68%; top:14%}
.sparkles span:nth-child(5){left:84%; top:24%}
.sparkles span:nth-child(6){left:18%; top:72%}
.sparkles span:nth-child(7){left:34%; top:82%}
.sparkles span:nth-child(8){left:62%; top:78%}
.sparkles span:nth-child(9){left:78%; top:70%}
.sparkles span:nth-child(10){left:90%; top:84%}

.stage-top{text-align:center}
.mini-badge{
  display:inline-block;
  padding:8px 12px;
  border-radius:999px;
  background:rgba(0,0,0,.16);
  border:1px solid rgba(255,255,255,.14);
  font-weight:800;
  letter-spacing:.1em;
  font-size:12px;
}
.hny{margin:12px 0 4px; line-height:1}
.hny-1,.hny-2{
  display:block;
  font-family:"Lobster", system-ui;
  /* Responsive to short screens so it doesn't get clipped */
  font-size:clamp(40px, 6.5svh, 56px);
  text-shadow:0 18px 30px rgba(0,0,0,.28);
}
.hny-2{color:var(--gold)}
.big-year{
  font-family:"Caramel", system-ui;
  font-size:clamp(68px, 10svh, 92px);
  color:rgba(255,210,122,.92);
  margin-top:2px;
  transform:rotate(-4deg);
  text-shadow:0 22px 40px rgba(0,0,0,.25);
}

.stage-mid{
  position:relative;
  height:clamp(240px, 38svh, 340px);
  margin:12px 0 8px;
  display:flex;
  align-items:flex-end;
  justify-content:center;
}

.lantern-big{position:absolute; left:16px; bottom:70px; transform-origin:50% 0}
.swing{animation:swing 2.6s ease-in-out infinite}
@keyframes swing{0%,100%{transform:rotate(-4deg)}50%{transform:rotate(5deg)}}

.horse-hero{
  width:min(360px, 82vw);
  height:auto;
  filter: drop-shadow(0 22px 34px rgba(0,0,0,.35));
  transform:translateY(10px);
}

.stage-bottom{text-align:center}
.subline{margin:10px 0 0; opacity:.85}

/* Fireworks - appear when active */
.firework{
  position:absolute;
  right:10%;
  top:18%;
  width:140px;
  height:140px;
  border-radius:50%;
  background:
    radial-gradient(circle, rgba(255,210,122,.95) 0 3px, transparent 4px),
    radial-gradient(circle, rgba(255,255,255,.8) 0 2px, transparent 3px);
  opacity:0;
  transform:scale(.4);
  filter: drop-shadow(0 14px 20px rgba(0,0,0,.25));
}
.firework-2{left:10%; right:auto; top:30%; width:120px; height:120px}

.scene.active .firework{animation:boom 1.25s ease-out infinite}
.scene.active .firework-2{animation:boom 1.35s ease-out infinite .15s}
@keyframes boom{
  0%{opacity:0; transform:scale(.3) rotate(0deg)}
  15%{opacity:1}
  55%{opacity:.9}
  100%{opacity:0; transform:scale(1.05) rotate(18deg)}
}

/* Text pop when active */
.scene.active .hny-1{animation:pop .9s ease-out 1}
.scene.active .hny-2{animation:pop .9s ease-out 1 .06s}
@keyframes pop{0%{transform:translateY(10px); opacity:.7}100%{transform:translateY(0); opacity:1}}

/* Mail icon */
.mail{
  position:absolute;
  right:18px;
  bottom:18px;
  width:64px;
  height:52px;
  border:none;
  background:transparent;
  cursor:pointer;
  filter: drop-shadow(0 14px 20px rgba(0,0,0,.35));
  transform:translateY(0);
}
.mail-body{
  position:absolute;
  inset:8px 0 0 0;
  border-radius:12px;
  background:linear-gradient(180deg, rgba(255,210,122,.92), rgba(255,184,77,.86));
  border:1px solid rgba(255,255,255,.22);
}
.mail-top{
  position:absolute;
  left:0; right:0; top:8px;
  height:0;
  border-left:32px solid transparent;
  border-right:32px solid transparent;
  border-top:22px solid rgba(255,255,255,.28);
  opacity:.85;
}
.mail-heart{
  position:absolute;
  left:50%;
  top:22px;
  width:10px;
  height:10px;
  background:#ff2d41;
  transform:translateX(-50%) rotate(45deg);
  border-radius:2px;
}
.mail-heart::before,
.mail-heart::after{
  content:"";
  position:absolute;
  width:10px; height:10px;
  background:#ff2d41;
  border-radius:50%;
}
.mail-heart::before{left:-5px; top:0}
.mail-heart::after{left:0; top:-5px}

.scene.active .mail{animation:mailBounce 1.2s ease-in-out infinite}
@keyframes mailBounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}

/* Modal letter */
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.75); /* Tăng độ tối nền để thiệp nổi hơn */
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
  z-index: 1000; /* Đặt tầng rất cao để che mọi thứ phía dưới */
  backdrop-filter: blur(4px); /* Làm mờ nhẹ nền phía sau */
}

/* Cái thiệp Tết */
.letter {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  width: min(600px, 92vw);
  max-height: 85svh;
  overflow-y: auto;
  padding: 25px;
  border-radius: 24px;
  
  /* Đảm bảo màu nền thiệp trắng sáng, không bị ảnh hưởng bởi nền đỏ */
  background: #ffffff; 
  color: #2a0a0f;
  
  /* Đổ bóng mạnh để tạo cảm giác tách biệt khỏi nền */
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 20px rgba(255, 210, 122, 0.3);
  
  opacity: 0;
  pointer-events: none;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  z-index: 1001; 
}

.overlay.show {
  opacity: 1;
  pointer-events: auto;
}

.letter.show {
  opacity: 1;
  pointer-events: auto;
  transform: translate(-50%, -50%) scale(1); /* Hiệu ứng bung ra */
}
.letter-title{margin:8px 0 6px; font-family:"Lobster", system-ui; font-size:32px; color:#8e1022}
.letter-text{margin:0 0 10px; line-height:1.55}
.letter-footer{opacity:.85; font-weight:700}
.close{
  position:absolute;
  right:14px;
  top:10px;
  width:36px;
  height:36px;
  border:none;
  border-radius:999px;
  background:rgba(0,0,0,.06);
  font-size:22px;
  cursor:pointer;
}

.letter.show{opacity:1; pointer-events:auto; transform:translate(-50%,-50%) scale(1)}
.overlay.show{opacity:1; pointer-events:auto}

@media (max-width:640px){
  .hny-1,.hny-2{font-size:44px}
  .big-year{font-size:78px}
  .stage-mid{height:320px}
  .lantern-big{left:10px; bottom:85px; transform:scale(.9);}
}


/* Nice scrollbar (WebKit) */
.scene::-webkit-scrollbar,
.page-countdown .shell::-webkit-scrollbar{
  width:10px;
}
.scene::-webkit-scrollbar-thumb,
.page-countdown .shell::-webkit-scrollbar-thumb{
  background:rgba(255,255,255,.22);
  border-radius:999px;
  border:2px solid rgba(0,0,0,.12);
}
.scene::-webkit-scrollbar-track,
.page-countdown .shell::-webkit-scrollbar-track{
  background:transparent;
}


/* Fortune draw */
.fortune{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:18px;
  background:rgba(0,0,0,.18);
  backdrop-filter: blur(8px);
  z-index:30;
  transition:opacity .22s ease;
}
.fortune.hide{
  opacity:0;
  pointer-events:none;
  transition:opacity .22s ease;
}
.fortune-panel{
  width:min(520px, 92vw);
  padding:18px 18px 16px;
  text-align:center;
  border-radius:24px;
}
.fortune-title{
  font-family:"Lobster", system-ui;
  font-size:34px;
  margin:4px 0 12px;
  text-shadow:0 14px 28px rgba(0,0,0,.18);
}
.fortune-img{
  width:min(230px, 58vw);
  height:auto;
  display:block;
  margin:0 auto 14px;
  filter: drop-shadow(0 20px 34px rgba(0,0,0,.30));
  animation:fortuneFloat 2.9s ease-in-out infinite;
}
@keyframes fortuneFloat{
  0%,100%{transform:translateY(0) rotate(-1deg)}
  50%{transform:translateY(-8px) rotate(1deg)}
}
.fortune-hint{
  margin-top:10px;
  font-size:14px;
  opacity:.92;
}

/* Letter quote styling */
.letter-meta{
  margin:0 0 8px;
  opacity:.8;
  font-weight:700;
}
.letter-quote{
  margin:0 0 6px;
  font-size:18px;
  line-height:1.65;
}
